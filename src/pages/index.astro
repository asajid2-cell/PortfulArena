---
import BaseLayout from '../layouts/BaseLayout.astro';
import SectionHeader from '../components/SectionHeader.astro';
import { FeaturedProjects } from '../components/projects/FeaturedProjects.tsx';
import { HeroArena } from '../components/arena/HeroArena.tsx';
import type { ArenaProject } from '../lib/types';
import { getCollection } from 'astro:content';

const projectEntries = await getCollection('projects');

const projects: ArenaProject[] = projectEntries
  .map(({ slug, data }) => ({
    slug,
    ...data,
    heroImage: data.heroImage ? data.heroImage.src : undefined
  }))
  .sort((a, b) => (a.order ?? 99) - (b.order ?? 99));

const featuredProjects = projects.filter((project) => project.featured);
---

<BaseLayout title="Portful | Portful Studio">
  <section class="relative overflow-hidden bg-[color:var(--bg-1)]">
    <div class="mx-auto flex max-w-[1280px] flex-col gap-10 px-6 py-24 sm:px-12 sm:py-32 lg:flex-row lg:items-center lg:px-16">
      <div class="max-w-2xl space-y-6">
        <p class="inline-flex items-center gap-2 rounded-full border border-[color:var(--line-1)] bg-[color:rgba(117,32,55,0.18)] px-4 py-2 text-xs uppercase tracking-[0.3em] text-[color:var(--pri-300)]">
          <span class="h-1.5 w-1.5 rounded-full bg-[color:var(--pri-500)]"></span>
          Portful Studio
        </p>
        <h1 class="font-display text-5xl font-bold tracking-tight text-[color:var(--text-1)] sm:text-6xl">
          Software with a steady hand and a human voice.
        </h1>
        <p class="max-w-xl text-lg text-[color:var(--text-2)]">
          I design and build digital products that feel intentionalâ€”lean motion, clear stories, and interfaces that behave as well as they look. If you need a partner who keeps both craft and delivery
          in focus, let's talk.
        </p>
        <div class="flex flex-col gap-4 sm:flex-row">
          <a
            href="/projects"
            class="inline-flex items-center justify-center rounded-full border border-transparent bg-[color:var(--pri-500)] px-6 py-3 text-sm font-semibold text-white shadow-[0_14px_32px_rgba(160,80,123,0.22)] transition-transform duration-120 ease-launch hover:translate-y-[-2px] focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-[color:var(--pri-400)] focus-visible:ring-offset-2 focus-visible:ring-offset-[color:var(--bg-0)]"
          >
            View projects
          </a>
          <a
            href="/contact"
            class="inline-flex items-center justify-center rounded-full border border-[color:var(--line-1)] px-6 py-3 text-sm font-semibold text-[color:var(--text-1)] transition duration-120 ease-settle hover:border-[color:var(--pri-500)] hover:text-[color:var(--pri-300)] focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-[color:var(--pri-400)] focus-visible:ring-offset-2 focus-visible:ring-offset-[color:var(--bg-0)]"
          >
            Start a conversation
          </a>
        </div>
      </div>
      <HeroArena client:visible />
    </div>
  </section>

  <section class="relative border-t border-[color:var(--line-1)] bg-[color:var(--bg-0)] py-24 sm:py-32">
    <div class="pointer-events-none absolute inset-x-0 top-0 h-px bg-gradient-to-r from-transparent via-[color:rgba(160,80,123,0.35)] to-transparent"></div>
    <div class="mx-auto flex max-w-[1280px] flex-col gap-16 px-6 sm:px-12 lg:px-16">
      <SectionHeader eyebrow="Projects" title="Featured work" description="Recent builds and collaborations that show how I balance systems thinking with tactile detail." />
      {featuredProjects.length === 0 ? (
        <div class="rounded-card border border-dashed border-[color:var(--line-1)] bg-[color:rgba(74,4,4,0.45)] p-8 text-[color:var(--text-3)]">
          Projects will appear here as soon as you add them to the content collection.
        </div>
      ) : (
        <FeaturedProjects projects={featuredProjects} client:visible />
      )}
    </div>
  </section>

  <section class="border-t border-[color:var(--line-1)] bg-[color:var(--bg-1)] py-24 sm:py-32">
    <div class="mx-auto grid max-w-[1280px] gap-12 px-6 sm:px-12 lg:grid-cols-[1fr,1.2fr] lg:px-16">
      <SectionHeader eyebrow="How I help" title="Practical specialties" />
      <div class="grid gap-8 text-[color:var(--text-2)]">
        <div class="rounded-card border border-[color:var(--line-1)] bg-[color:rgba(86,22,43,0.85)] p-6 shadow-ambient">
          <h3 class="font-display text-xl text-[color:var(--text-1)]">Interactive experiences</h3>
          <p class="mt-3 text-sm">
            React and WebGL work that stays performant and accessible. Lightweight shaders when they help, graceful fallbacks when they do not.
          </p>
        </div>
        <div class="rounded-card border border-[color:var(--line-1)] bg-[color:rgba(86,22,43,0.85)] p-6 shadow-ambient">
          <h3 class="font-display text-xl text-[color:var(--text-1)]">Product engineering</h3>
          <p class="mt-3 text-sm">
            Full-stack product work across Astro, Next.js, and serverless stacks. I stay with a feature from prototype through launch, wiring in analytics and accessibility along the way.
          </p>
        </div>
        <div class="rounded-card border border-[color:var(--line-1)] bg-[color:rgba(86,22,43,0.85)] p-6 shadow-ambient">
          <h3 class="font-display text-xl text-[color:var(--text-1)]">Performance & systems</h3>
          <p class="mt-3 text-sm">
            Performance reviews, build pipelines, and design systems that keep releases calm: <span class="font-mono">LCP &lt; 2s</span>, steady CLS, and JS budgets that respect the device.
          </p>
        </div>
      </div>
    </div>
  </section>
</BaseLayout>
